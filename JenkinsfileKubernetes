node{
     
    stage('SCM Checkout'){
        git url:  'https://github.com/sonali-source/Repo.git',branch: 'master'
    }
    
   }
    
    
  stage('Build Docker Image'){
      sh 'docker rmi -f sonali192/spring-boot-mongo'
      sh 'docker build -t sonali192/spring-boot-mongo .'
    }
    



    
  stage {'push docker image to ACr/Dcokerhub'}
   { steps { // This step should not normally be used in your script. Consult the inline help for details.
withDockerRegistry(credentialsId: 'DockerHubReg', url: 'https://index.docker.io/v1/') {
   sh 'docker push pkw0301/spring-boot-mongo'
} }}
     
     
     stage("Deploy To Kuberates Cluster")
     {
     sh "kubernetesDeploy configs: 'springBootMongo.yml', kubeConfig: [path: '/var/lib/jenkins/workspace/kubeconfig'], kubeconfigId: 'kubetntes', secretName: '', ssh: [sshCredentialsId: 'ssh-k8smaster', sshServer: '3.71.27.155'], textCredentials: [certificateAuthorityData: '', clientCertificateData: '', clientKeyData: '', serverUrl: 'https://']"
       }
	 
    
}
}


